### 第一章 最优化理论基础（无约束问题的最优性条件）
先明确符号：\( g(x)=\nabla f(x) \)，\( g_k=\nabla f(x_k) \)，\( G(x)=\nabla^2 f(x) \)，\( G_k=\nabla^2 f(x_k) \)。


#### 定理6（一阶段必要条件）
设 \( f(x) \) 在开集 \( D \) 上一阶连续可微，若 \( x^* \in D \) 是 \( \boxed{f(x)} \) 的一个局部极小点，则必有 \( g(x^*) = 0 \)。

**证明**：
取 \( x = x^* - \alpha g(x^*) \in D \)（\( \alpha > 0 \) 为某个常数），由一阶泰勒展开：
\[
f(x) = f(x^*) + g(x^*)^T(x - x^*) + o(\|x - x^*\|) = f(x^*) - \alpha \|g(x^*)\|^2 + o(\alpha)
\]
因 \( x^* \) 是局部极小点，故 \( f(x) \geq f(x^*) \)，结合 \( \alpha > 0 \)，得：
\[
0 \leq \|g(x^*)\|^2 + \frac{o(\alpha)}{\alpha}
\]
令 \( \alpha \to 0 \)，则 \( \|g(x^*)\| = 0 \)，即 \( g(x^*) = 0 \)。


#### 定理7（二阶必要条件）
设 \( f(x) \) 在开集 \( D \) 上二阶连续可微，若 \( x^* \in D \) 是 \( \boxed{f(x)} \) 的一个局部极小点，则必有 \( g(x^*) = 0 \) 且 \( G(x^*) \) 半正定矩阵。

**证明**：
由定理6知 \( g(x^*) = 0 \)，下证 \( G(x^*) \) 半正定。任取 \( x = x^* + \alpha d \in D \)（\( \alpha > 0 \)，\( d \in \mathbb{R}^n \)），由二阶泰勒展开：
\[
0 \leq f(x) - f(x^*) = \frac{1}{2}\alpha^2 d^T G(x^*)d + o(\alpha^2)
\]
即：
\[
d^T G(x^*)d + \frac{o(\alpha^2)}{\alpha^2} \geq 0
\]
令 \( \alpha \to 0 \)，得 \( d^T G(x^*)d \geq 0 \)，故 \( G(x^*) \) 半正定。


#### 定理8（二阶充分条件）
设 \( f(x) \) 在开集 \( D \) 上二阶连续可微，若 \( x^* \in D \) 满足 \( g(x^*) = 0 \) 且 \( G(x^*) \) 正定矩阵，则 \( x^* \) 是 \( \boxed{f(x)} \) 的一个局部极小点。

**证明**：
任取 \( x = x^* + \alpha d \in D \)（\( \alpha > 0 \)，\( d \in \mathbb{R}^n \)），由二阶泰勒公式：
\[
f(x^* + \alpha d) = f(x^*) + g(x^*)^T d + \frac{1}{2}\alpha^2 d^T G(x^* + \theta \alpha d)d
\]
（其中 \( \theta \in (0,1) \)）。因 \( g(x^*) = 0 \)，且 \( G(x) \) 二阶连续可微，故存在 \( \delta > 0 \)，使得 \( \|\alpha d\| < \delta \) 时 \( G(x^* + \theta \alpha d) \) 正定。因此上式得：
\[
f(x^* + \alpha d) > f(x^*)
\]
即 \( x^* \) 是局部极小点。


#### 定理9（凸函数的全局极小点条件）
设 \( f(x) \) 在 \( \mathbb{R}^n \) 上是凸函数且一阶连续可微，则 \( x^* \in \mathbb{R}^n \) 是 \( \boxed{f(x)} \) 的全局极小点的充要条件是 \( g(x^*) = 0 \)。

**证明**：
必要性显然，仅证充分性。设 \( g(x^*) = 0 \)，由凸函数的判别定理，对 \( \forall x \in \mathbb{R}^n \)，有：
\[
f(x) \geq f(x^*) + g(x^*)^T(x - x^*) = f(x^*)
\]
故 \( x^* \) 是全局极小点。


（注：目标函数的稳定点不一定是极小点，但凸函数的无约束优化问题中，稳定点、局部极小点、全局极小点三者等价。）



### 约束问题的最优性条件

等式约束问题的**一阶必要条件**，即为 KT 条件（Kuhn-Tucker），也叫拉格朗日定理。

### 定理39（KT一阶必要条件）
设\( x^* \)是一般约束问题\(\boxed{(8.11)}\)的局部极小点，在\( x^* \)处的有效约束集为：
\[ S(x^*) = E \cup I(x^*) = E \cup \{i \mid g_i(x^*) = 0,\ i \in I\} \tag{8.12} \]
若\( f(x) \)、\( h_i(x)\ (i \in E) \)、\( g_i(x)\ (i \in I) \)在\( x^* \)处可微，且向量组\( \nabla h_i(x^*)\ (i \in E) \)、\( \nabla g_i(x^*)\ (i \in I(x^*)) \)线性无关，则存在向量\( (\mu^*, \lambda^*) \in \mathbb{R}^l \times \mathbb{R}^m \)（其中\( \mu^* = (\mu_1^*, \cdots, \mu_l^*)^T \)，\( \lambda^* = (\lambda_1^*, \cdots, \lambda_m^*)^T \)），使得：
\[
\begin{cases}
\nabla f(x^*) - \sum_{i=1}^l \mu_i^* \nabla h_i(x^*) - \sum_{i=1}^m \lambda_i^* \nabla g_i(x^*) = 0, \\
h_i(x^*) = 0,\ i \in E, \\
g_i(x^*) \geq 0,\ \lambda_i^* \geq 0,\ \lambda_i^* g_i(x^*) = 0,\ i \in I.
\end{cases} \tag{8.13}
\]


**注3**：
1. 式\((8.13)\)称为**KT条件**，满足该条件的点\( x^* \)称为**KT点**；\( (x^*, (\mu^*, \lambda^*)) \)称为**KT对**，其中\( (\mu^*, \lambda^*) \)是拉格朗日乘子。通常KT点、KT对、KT条件可混用。
2. \( \lambda_i^* g_i(x^*) = 0\ (i \in I(x^*)) \)称为**互补性松弛条件**，即\( \lambda_i^* \)与\( g_i(x^*) \)至少有一个为0；若其中一个为0、另一个严格大于0，则称为满足**严格互补性松弛条件**。


### 定理40（KT点的二阶充分条件）
对于约束优化问题\(\boxed{(8.11)}\)，假设\( f(x) \)、\( g_i(x)\ (i \in I) \)、\( h_i(x)\ (i \in E) \)都是二阶连续可微的，有效约束集\( I(x^*) \)由式\((8.12)\)定义，且\( (x^*, (\mu^*, \lambda^*)) \)是问题\((8.11)\)的KT点。
若对任意非零向量\( d \in \mathbb{R}^n \)（满足\( \nabla g_i(x^*)^T d = 0\ (i \in I(x^*)) \)、\( \nabla h_i(x^*)^T d = 0\ (i \in E) \)），均有：
\[ d^T \nabla_{xx}^2 L(x^*, \lambda^*) d > 0 \]
则\( x^* \)是问题\((8.11)\)的一个**严格局部极小点**（其中\( L(x, \lambda) \)是拉格朗日函数）。